---
title: 'Supplementary material of UniqTag: Content-derived unique and stable identifiers for gene annotation'
author: 'Shaun Jackman'
---

```{r install.packages, eval=FALSE, include=FALSE}
install.packages('ggplot2')
install.packages('reshape2')
install.packages('scales')
```

# Load libraries
```{r libraries}
library(ggplot2)
library(reshape2)
library(scales) # for alpha
```

# Read the data
```{r data}
data.orig <- read.delim('uniqtag.tsv',
	colClasses = c(A = 'factor', B = 'factor'))
x <- do.call(rbind, strsplit(as.character(data.orig$Table), '.', fixed = TRUE))
colnames(x) <- c('Data', 'Transform', 'Identifier')
data <- cbind(data.orig, x)

build.wide <- with(data,
	data.frame(Build.A = A, Build.B = B,
		Num.A = Only.A + Both, Num.B = Only.B + Both))
build.tall <- melt(build.wide, id.vars = c('Build.A', 'Build.B'),
	variable.name = 'Build', value.name = 'Count')
```

# Plot the number of common identifiers vs. older build
The intersection of gene name, Protein ID (ENSP), exact sequence and UniqTag identifiers between older builds of the Ensembl human genome and the current build 75.
```{r ensembl, fig.width=6, fig.height=5, dpi=150}
aes.data <- aes(x = A, y = Both,
	group = Table, color = Identifier)
aes.build <- aes(x = Build.A, y = Count,
	group = Build, shape = Build)
ggplot() +
	geom_point(aes.data, data) +
	geom_line(aes.data, data) +
	scale_color_brewer(palette = 'Set1',
		breaks = c('gene', 'uniqtag7', 'id', 'seq'),
		labels = c('Gene name', 'UniqTag',
			'Protein ID (ENSP)', 'Polypeptide sequence')) +

	geom_point(aes.build, build.tall) +
	geom_line(aes.build, build.tall, linetype = 'dashed') +
	scale_shape(name = 'Number of genes',
		breaks = c('Num.B', 'Num.A'),
		labels = c('Ensembl build 75', 'Older Ensembl build')) +

	theme_bw() +
	theme(legend.position = c(1.0, 0),
		legend.justification = c(1, 0),
		legend.box.just = 'right',
		legend.background = element_rect(fill = alpha('white', 0))) +
	xlab('Older Ensembl build') +
	ylab('Identifiers in common with Ensembl build 75')
```
